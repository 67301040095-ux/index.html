<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Modern Chiller Plant 3D - Clean Version</title>
<style>
body { margin:0; overflow:hidden; background:#eef1f5; }
button{
  position:fixed;
  top:20px;
  left:20px;
  padding:10px 20px;
  font-size:16px;
  z-index:10;
}
</style>
</head>
<body>

<button onclick="startSystem()">START SYSTEM</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>

<script>

// ================= SCENE =================
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
60,
window.innerWidth/window.innerHeight,
0.1,
2000
);
camera.position.set(160,100,220);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping = true;

// ================= LIGHT =================
scene.add(new THREE.AmbientLight(0xffffff,0.6));

const light = new THREE.DirectionalLight(0xffffff,0.8);
light.position.set(200,200,100);
light.castShadow = true;
scene.add(light);

// ================= MATERIAL =================
const whiteMat = new THREE.MeshStandardMaterial({
color:0xffffff,
metalness:0.3,
roughness:0.4
});

const metalMat = new THREE.MeshStandardMaterial({
color:0xd0d5db,
metalness:0.8,
roughness:0.3
});

const darkMat = new THREE.MeshStandardMaterial({
color:0x555b66,
metalness:0.7,
roughness:0.4
});

const accentMat = new THREE.MeshStandardMaterial({
color:0x2d6cdf,
metalness:0.6,
roughness:0.3
});

// ================= GROUND =================
const ground = new THREE.Mesh(
new THREE.PlaneGeometry(600,600),
new THREE.MeshStandardMaterial({color:0xffffff})
);
ground.rotation.x = -Math.PI/2;
ground.receiveShadow = true;
scene.add(ground);

// ================= COOLING TOWER =================
function createCT(x,z){

const group = new THREE.Group();

// base
const base = new THREE.Mesh(
new THREE.BoxGeometry(28,4,28),
metalMat
);
base.position.y = 2;
group.add(base);

// body
const body = new THREE.Mesh(
new THREE.BoxGeometry(22,36,22),
whiteMat
);
body.position.y = 22;
group.add(body);

// louver lines
for(let i=-10;i<=10;i+=4){
const line = new THREE.Mesh(
new THREE.BoxGeometry(22,0.4,0.6),
metalMat
);
line.position.set(0,20+i,11.5);
group.add(line);
}

// fan hub
const hub = new THREE.Mesh(
new THREE.CylinderGeometry(2,2,2,32),
darkMat
);
hub.rotation.x = Math.PI/2;
hub.position.y = 42;
group.add(hub);

// fan blades
const blades = new THREE.Group();
for(let i=0;i<6;i++){
const blade = new THREE.Mesh(
new THREE.BoxGeometry(16,1,3),
darkMat
);
blade.position.x = 8;
blade.rotation.y = Math.PI/10;
const pivot = new THREE.Group();
pivot.add(blade);
pivot.rotation.y = (i/6)*Math.PI*2;
blades.add(pivot);
}
blades.rotation.y = Math.PI/2;
blades.position.y = 42;
group.add(blades);

group.position.set(x,0,z);
scene.add(group);

return blades;
}

// ================= CHILLER =================
function createChiller(x,z){

const group = new THREE.Group();

// condenser barrel
const barrel1 = new THREE.Mesh(
new THREE.CylinderGeometry(6,6,50,32),
whiteMat
);
barrel1.rotation.z = Math.PI/2;
barrel1.position.y = 12;
group.add(barrel1);

// evaporator barrel
const barrel2 = barrel1.clone();
barrel2.position.y = 24;
group.add(barrel2);

// saddles
for(let i=-18;i<=18;i+=36){
const saddle = new THREE.Mesh(
new THREE.BoxGeometry(6,4,6),
metalMat
);
saddle.position.set(i,6,0);
group.add(saddle);
}

// control panel
const panel = new THREE.Mesh(
new THREE.BoxGeometry(6,14,4),
accentMat
);
panel.position.set(-30,16,0);
group.add(panel);

group.position.set(x,0,z);
scene.add(group);
}

// ================= PUMP =================
function createPump(x,z){

const group = new THREE.Group();

// base
const base = new THREE.Mesh(
new THREE.BoxGeometry(24,2,10),
metalMat
);
base.position.y = 1;
group.add(base);

// casing
const casing = new THREE.Mesh(
new THREE.CylinderGeometry(5,5,8,32),
whiteMat
);
casing.rotation.z = Math.PI/2;
casing.position.set(-5,6,0);
group.add(casing);

// suction
const suction = new THREE.Mesh(
new THREE.CylinderGeometry(2,2,8,32),
metalMat
);
suction.rotation.z = Math.PI/2;
suction.position.set(-12,6,0);
group.add(suction);

// discharge
const discharge = suction.clone();
discharge.position.set(2,6,0);
group.add(discharge);

// motor
const motor = new THREE.Mesh(
new THREE.CylinderGeometry(3,3,18,32),
accentMat
);
motor.rotation.z = Math.PI/2;
motor.position.set(10,6,0);
group.add(motor);

group.position.set(x,0,z);
scene.add(group);
}

// ================= AHU =================
function createAHU(x,z){

const group = new THREE.Group();

const body = new THREE.Mesh(
new THREE.BoxGeometry(70,20,22),
whiteMat
);
body.position.y = 12;
group.add(body);

// module split
for(let i=-30;i<=30;i+=15){
const line = new THREE.Mesh(
new THREE.BoxGeometry(1,20,22),
metalMat
);
line.position.set(i,12,0);
group.add(line);
}

// return grill
const grill = new THREE.Mesh(
new THREE.BoxGeometry(16,10,1),
darkMat
);
grill.position.set(-30,12,11.5);
group.add(grill);

// supply outlet
const outlet = grill.clone();
outlet.position.set(30,12,11.5);
group.add(outlet);

group.position.set(x,0,z);
scene.add(group);
}

// ================= LAYOUT =================

const fan1 = createCT(-90,-70);
const fan2 = createCT(-55,-70);

[-95,-80,-65].forEach(x => createPump(x,-10));
createChiller(0,-20);
createChiller(0,-60);
[50,65,80].forEach(x => createPump(x,-10));
createAHU(140,-40);

// ================= SYSTEM =================
let systemOn = false;
let fanSpeed = 0;

function startSystem(){
setTimeout(()=>{ systemOn = true; },2000);
}

// ================= ANIMATION =================
function animate(){
requestAnimationFrame(animate);

if(systemOn){
fanSpeed = 0.1;
}

fan1.rotation.y += fanSpeed;
fan2.rotation.y += fanSpeed;

controls.update();
renderer.render(scene,camera);
}
animate();

window.addEventListener("resize",()=>{
camera.aspect = window.innerWidth/window.innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(window.innerWidth,window.innerHeight);
});

</script>
</body>
</html>
