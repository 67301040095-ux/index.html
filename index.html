<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Modern Chiller Plant 3D</title>
<style>
body { margin:0; overflow:hidden; background:#f4f6f8; }
button{
  position:fixed;
  top:20px;
  left:20px;
  padding:10px 20px;
  font-size:16px;
  z-index:10;
}
</style>
</head>
<body>

<button onclick="startSystem()">START SYSTEM</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>

<script>

// ================= SCENE =================
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
60,
window.innerWidth/window.innerHeight,
0.1,
2000
);
camera.position.set(160,90,200);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
renderer.shadowMap.enabled = true;
document.body.appendChild(renderer.domElement);

const controls = new THREE.OrbitControls(camera,renderer.domElement);
controls.enableDamping = true;

// ================= LIGHT =================
scene.add(new THREE.AmbientLight(0xffffff,0.6));

const dirLight = new THREE.DirectionalLight(0xffffff,0.8);
dirLight.position.set(200,200,100);
dirLight.castShadow = true;
scene.add(dirLight);

// ================= MATERIAL =================
const whiteMat = new THREE.MeshStandardMaterial({
color:0xfafafa,
metalness:0.3,
roughness:0.4
});

const metalMat = new THREE.MeshStandardMaterial({
color:0xd0d5db,
metalness:0.8,
roughness:0.3
});

const darkMat = new THREE.MeshStandardMaterial({
color:0x555b66,
metalness:0.7,
roughness:0.4
});

const accentMat = new THREE.MeshStandardMaterial({
color:0x2d6cdf,
metalness:0.6,
roughness:0.3
});

// ================= GROUND =================
const ground = new THREE.Mesh(
new THREE.PlaneGeometry(500,500),
new THREE.MeshStandardMaterial({color:0xffffff})
);
ground.rotation.x = -Math.PI/2;
ground.receiveShadow = true;
scene.add(ground);

// ================= COOLING TOWER =================
function createCT(x,z){

const group = new THREE.Group();

// base frame
const base = new THREE.Mesh(
new THREE.BoxGeometry(26,4,26),
metalMat
);
base.position.y = 2;
group.add(base);

// main body
const body = new THREE.Mesh(
new THREE.BoxGeometry(22,34,22),
whiteMat
);
body.position.y = 20;
group.add(body);

// panel lines
for(let i=-8;i<=8;i+=4){
const line = new THREE.Mesh(
new THREE.BoxGeometry(22,0.4,0.6),
metalMat
);
line.position.set(0,18+i,11.3);
group.add(line);
}

// fan deck
const deck = new THREE.Mesh(
new THREE.BoxGeometry(22,2,22),
metalMat
);
deck.position.y = 38;
group.add(deck);

// fan guard
const guard = new THREE.Mesh(
new THREE.TorusGeometry(8,0.3,16,60),
darkMat
);
guard.rotation.x = Math.PI/2;
guard.position.y = 40;
group.add(guard);

// fan blade
const fan = new THREE.Mesh(
new THREE.CylinderGeometry(7,7,1.5,40),
darkMat
);
fan.rotation.x = Math.PI/2;
fan.position.y = 40;
group.add(fan);

group.position.set(x,0,z);
scene.add(group);

return fan;
}

// ================= CHILLER =================
function createChiller(x,z){

const group = new THREE.Group();

// condenser barrel
const barrel1 = new THREE.Mesh(
new THREE.CylinderGeometry(6,6,50,32),
whiteMat
);
barrel1.rotation.z = Math.PI/2;
barrel1.position.y = 12;
group.add(barrel1);

// evaporator barrel
const barrel2 = barrel1.clone();
barrel2.position.y = 22;
group.add(barrel2);

// saddle supports
for(let i=-15;i<=15;i+=30){
const saddle = new THREE.Mesh(
new THREE.BoxGeometry(6,4,6),
metalMat
);
saddle.position.set(i,6,0);
group.add(saddle);
}

// control panel
const panel = new THREE.Mesh(
new THREE.BoxGeometry(6,12,4),
accentMat
);
panel.position.set(-28,14,0);
group.add(panel);

group.position.set(x,0,z);
scene.add(group);
}

// ================= PUMP =================
function createPump(x,z){

const group = new THREE.Group();

// base frame
const base = new THREE.Mesh(
new THREE.BoxGeometry(16,3,8),
metalMat
);
base.position.y = 1.5;
group.add(base);

// casing
const casing = new THREE.Mesh(
new THREE.SphereGeometry(4,32,32),
whiteMat
);
casing.position.set(-2,6,0);
group.add(casing);

// motor
const motor = new THREE.Mesh(
new THREE.CylinderGeometry(3,3,14,32),
accentMat
);
motor.rotation.z = Math.PI/2;
motor.position.set(6,6,0);
group.add(motor);

group.position.set(x,0,z);
scene.add(group);
}

// ================= AHU =================
function createAHU(x,z){

const group = new THREE.Group();

const body = new THREE.Mesh(
new THREE.BoxGeometry(50,18,18),
whiteMat
);
body.position.y = 10;
group.add(body);

// panel lines
for(let i=-20;i<=20;i+=10){
const line = new THREE.Mesh(
new THREE.BoxGeometry(0.5,18,18),
metalMat
);
line.position.set(i,10,0);
group.add(line);
}

group.position.set(x,0,z);
scene.add(group);
}

// ================= LAYOUT =================

const fan1 = createCT(-90,-60);
const fan2 = createCT(-55,-60);

[-95,-80,-65].forEach(x => createPump(x,-10));
createChiller(0,-20);
createChiller(0,-60);
[50,65,80].forEach(x => createPump(x,-10));
createAHU(130,-40);

// ================= SYSTEM =================
let systemOn = false;
let fanSpeed = 0;

function startSystem(){
setTimeout(()=>{
systemOn = true;
},2000);
}

// ================= ANIMATION =================
function animate(){
requestAnimationFrame(animate);

if(systemOn){
fanSpeed = 0.08;
}

fan1.rotation.z += fanSpeed;
fan2.rotation.z += fanSpeed;

controls.update();
renderer.render(scene,camera);
}
animate();

// resize
window.addEventListener("resize",()=>{
camera.aspect = window.innerWidth/window.innerHeight;
camera.updateProjectionMatrix();
renderer.setSize(window.innerWidth,window.innerHeight);
});

</script>
</body>
</html>
